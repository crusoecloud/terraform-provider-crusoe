stages:
  - lint
  - test

lint:
  stage: lint
  image: golang:1.19
  script:
    - go install github.com/golangci/golangci-lint/cmd/golangci-lint@v1.52.2
    - golangci-lint run
  only:
    - main
    - tags/^v.*/
    - merge_requests

test:
  stage: test
  image: golang:1.19
  script:
    - go test -count=1 -parallel=4 ./...
  only:
    - main
    - tags/^v.*/
    - merge_requests
